# 総合課題実習.py 使い方ガイド

## 📋 このプログラムについて

「Python 総合課題実習」の要件を満たすデータ分析プログラムです。
以下の8つの分析を自動的に実行します：

1. ✅ データインポート・連結
2. ✅ 外れ値処理
3. ✅ 基本統計量
4. ✅ ヒストグラム・散布図作成
5. ✅ クロス集計・相関分析
6. ✅ ダミー変数
7. ✅ t検定
8. ✅ 回帰分析

---

## 🚀 実行方法

### ステップ1: プログラムを起動

コマンドプロンプトまたはターミナルで以下を実行：

```bash
python 総合課題実習.py
```

または、VSCodeなどのエディタで `総合課題実習.py` を開いて「実行」ボタンをクリック。

---

### ステップ2: データファイルを指定

プログラムが起動すると、最初に以下のメッセージが表示されます：

```
【1. データインポート・連結】
----------------------------------------------------------------------
分析するデータファイルを読み込みます。
※ データがない場合は 'sample' と入力するとサンプルデータを作成します。

ファイルパス:
```

ここで **2つの選択肢** があります：

#### 選択肢A: 自分のデータを使う場合

CSVファイルまたはTXTファイルのパスを入力します。

**例：**
```
ファイルパス: C:\Users\ryoya\Downloads\SSDSE-B-2025.csv
```

または

```
ファイルパス: SSDSE-B-2025.csv
```
（プログラムと同じフォルダにある場合）

#### 選択肢B: サンプルデータを使う場合（推奨）

データがない場合や、まずテストしたい場合は：

```
ファイルパス: sample
```

と入力すると、Airbnb風のサンプルデータが自動生成されます。

---

### ステップ3: 外れ値処理

データが読み込まれると、外れ値処理の画面になります：

```
【2. 外れ値処理】
----------------------------------------------------------------------
数値列: price, minimum_nights, number_of_reviews, ...

外れ値処理する列名を入力 (スキップする場合はEnter):
```

**操作方法：**
- 外れ値を処理したい列名を入力（例: `price`）
- スキップしたい場合は何も入力せず **Enter** を押す

列名を入力すると、IQR法で外れ値が検出され：

```
外れ値を削除しますか？ (y/n):
```

と聞かれます。
- `y` → 外れ値を削除
- `n` → そのまま進む

---

### ステップ4: 基本統計量と可視化

自動的に以下が実行されます：
- 基本統計量の表示
- ヒストグラムの作成（`ヒストグラム.png`として保存）
- 散布図の作成（`散布図.png`として保存）

**何も入力する必要はありません。** 自動で進みます。

---

### ステップ5: 相関分析とクロス集計

自動的に以下が実行されます：
- 相関行列の表示
- 相関ヒートマップの作成（`相関分析.png`として保存）
- カテゴリ変数のクロス集計
- ダミー変数化

**何も入力する必要はありません。** 自動で進みます。

---

### ステップ6: t検定

自動的に2群間の平均値の差を検定します。

**何も入力する必要はありません。** 自動で進みます。

---

### ステップ7: 回帰分析

最後に回帰分析を行います。ここで **入力が必要** です：

```
【8. 回帰分析】
----------------------------------------------------------------------
利用可能な数値列: price, minimum_nights, number_of_reviews, ...

目的変数 (Y) の列名:
```

**操作方法：**

1. **目的変数（予測したい値）** を入力
   - 例: `price` （価格を予測したい場合）

2. **説明変数（予測に使う値）** をカンマ区切りで入力
   - 例: `number_of_reviews,availability_365`

入力例：
```
目的変数 (Y) の列名: price
説明変数 (X) の列名 (カンマ区切り): number_of_reviews,availability_365
```

すると、回帰分析の結果が表示され、`回帰分析結果.txt` に保存されます。

---

### ステップ8: 完了

```
======================================================================
  すべての分析が完了しました
======================================================================
```

と表示されたら終了です！

---

## 📁 生成されるファイル

プログラムを実行すると、以下のファイルが作成されます：

| ファイル名 | 内容 |
|-----------|------|
| `sample_airbnb_data.csv` | サンプルデータ（sampleを選んだ場合） |
| `ヒストグラム.png` | 各変数の分布図 |
| `散布図.png` | 変数間の散布図行列 |
| `相関分析.png` | 相関係数のヒートマップ |
| `回帰分析結果.txt` | 回帰分析の詳細結果 |

---

## 💡 よくある質問

### Q1: エラーが出た場合は？

**A:** 以下を確認してください：
- 必要なライブラリがインストールされているか
  ```bash
  pip install pandas numpy matplotlib seaborn statsmodels scipy
  ```
- ファイルパスが正しいか（スペースや日本語が含まれる場合は注意）

### Q2: データがない場合は？

**A:** `sample` と入力すれば、テスト用のサンプルデータが自動生成されます。

### Q3: 途中でスキップできますか？

**A:** 外れ値処理と回帰分析の一部は、Enterキーを押すことでスキップできます。

### Q4: グラフが表示されない

**A:** グラフは自動的にPNGファイルとして保存されます。プログラムと同じフォルダを確認してください。

---

## 🎯 簡単な実行例

最も簡単な使い方：

1. プログラムを起動
   ```bash
   python 総合課題実習.py
   ```

2. `sample` と入力してEnter

3. 外れ値処理で `price` と入力 → `y` と入力

4. 回帰分析で：
   - 目的変数: `price`
   - 説明変数: `number_of_reviews,availability_365`

5. 完了！

---

これで一通りの分析が完了し、すべての要件を満たした結果が得られます！
